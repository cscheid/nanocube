m1 = [
    [0.4761821826756046,0.4454116213040956,0.44465529972274176,0.4454384256374407,0.4134369361707006,0.07676583342508955,0.010453291525448239,0.012462813834359094,0.019419795043055767,0.0355031697191434],
    [0.16368427670315555,-0.08267933516892047,-0.08551054289787921,-0.08249495424267345,-0.1159537679804438,0.938423069431472,0.11592773684580461,0.11222886448911551,0.1279715161179508,0.12553769948393267],
    [-0.06515284096853724,0.02164585011655583,0.022881683231846386,0.022400248700735467,-0.041850916552615226,-0.23477847989791734,0.4391874447717735,0.4983372225737086,0.5702352480533839,0.41351535752311575]
];
m2 =[
    [0.40593752992603327,0.45630596956098957,0.45486296617856947,0.45602023718868145,0.44201036095254115,0.12430390162131036,0.019203370435812297,0.01122083108293819,0.012310266773483845,0.02596094975481013], [-0.0430525317726233,-0.058963909048859904,-0.06321973317053983,-0.059983745233820746,-0.057592323774911844,0.987412677593259,0.06958000756946764,0.034253378302403624,0.029974623417287658,0.04314083362695386],  [-0.9032942901947502,0.18759019148453568,0.1854359064967419,0.19060771533750803,0.23865542092017147,-0.0045980264221512305,0.11245320353024442,0.05261030679022611,0.043989212050366835,0.06184980899528869]
]
m3 = [
    [-0.00954471956321627,-0.01230583274604261,-0.01233853596116421,-0.012201385700456908,-0.013464613087486657,0.0019343095621064807,-0.006831321590910277,-0.9995907018033505,-0.003746471184511718,-0.005388880626118969],
    [0.399992869250918,0.4322460243635058,0.4322901639465753,0.4318225150534531,0.46998087096256275,-0.15038566173145615,0.17072045066425365,-0.0280393462670503,0.025011101435052766,0.07595070693610104],    [0.07770723740068516,0.09036863793813164,0.08867979323356205,0.08971044160172814,0.03713703784481096,-0.05921167818581453,-0.9770549150122256,0.0026537179974601907,-0.08106625890189122,-0.06150411008918001]
]
m4 = [
    [-0.00954471956321627,-0.01230583274604261,-0.01233853596116421,-0.012201385700456908,-0.013464613087486657,0.0019343095621064807,-0.006831321590910277,-0.9995907018033505,-0.003746471184511718,-0.005388880626118969],
    [-0.399992869250918,-0.4322460243635058,-0.4322901639465753,-0.4318225150534531,-0.46998087096256275,0.15038566173145615,-0.17072045066425365,0.0280393462670503,-0.025011101435052766,-0.07595070693610104],    [0.07770723740068516,0.09036863793813164,0.08867979323356205,0.08971044160172814,0.03713703784481096,-0.05921167818581453,-0.9770549150122256,0.0026537179974601907,-0.08106625890189122,-0.06150411008918001]
]

function plot(d) {
    var vExtent = {
        0 : d3.extent(d[0], function(d){ return d;}),
        1 : d3.extent(d[1], function(d){ return d;}),
        2 : d3.extent(d[2], function(d){ return d;})
    }
    d = [].concat.apply([], d);
    var vColorScale = d3.scale.linear().range(['#d73027', '#bdbdbd', '#4575b4']);
    var width = 600;
    var height = 160;
    var cellSize = 50;

    var mapSel = d3.select("#colormap").append('div')
                   .attr('clear', 'both')
                   .append("svg")
                   .attr('width', width)
                   .attr('height', height);

    mapSel.selectAll('rect').data(d).enter().append('rect')
          .attr('x', function(d,i) {
              return i%10*cellSize;
          })
          .attr('y', function(d,i){
              return Math.floor(i/10)*cellSize;
          })
          .attr('width', cellSize)
          .attr('height', cellSize)
          .attr('fill', function(d, i){ 
              var extent = vExtent[Math.floor(i/10)];
              var bound = Math.max(Math.abs(extent[0]), Math.abs(extent[1]));
              vColorScale.domain([-bound, 0, bound]).clamp(true);
              return vColorScale(d);})
          //.attr('stroke', 'black')
          .on('click', function(d){ console.log(d);}); 
}

function plotLegend(){
    var d = [0,2,3,4,5,6,7,8,9];
    var vColorScale = d3.scale.linear().domain([0,5,10]).range(['#d73027', '#bdbdbd', '#4575b4']);
    var sel = d3.select("#colormap").append('div')
        .attr('clear', 'both')
        .append('svg')
        .attr('width', 500)
        .attr('height', 50)

    sel.selectAll('rect').data(d).enter().append('rect')
        .attr('x', function(d, i){
            return i*50;
        })
        .attr('y', 10)
        .attr('width',50)
        .attr('height',30)
        .attr('fill', function(d){return vColorScale(d)});
}
